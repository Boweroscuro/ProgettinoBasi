{% extends "base.html" %}

{% block title %}
Storico Ordini
{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2 class="text-center mb-4">Storico Ordini</h2>
    {% if ordini %}
        {% set current_order_id = None %}
        {% for ordine in ordini %}
            {% if current_order_id != ordine.idor %}
                <!-- Intestazione per nuovo ordine -->
                {% if current_order_id is not none %}
                    </tbody>
                    </table>
                {% endif %}
                {% set current_order_id = ordine.idor %}
                
                <table class="table table-sm">
                    <thead>
                        <tr>
                            <th class="col-stato">ID Ordine</th>
                            <th class="col-prodotto">Prodotto</th>
                            <th class="col-stato">Data</th>
                            <th class="col-stato">Quantit√†</th>
                            <th class="col-stato">Pagato</th>
                            <th class="col-stato">Stato</th>
                        </tr>
                    </thead>
                    <tbody>
            {% endif %}
                        <tr>
                            <td class="col-stato">{{ ordine.idor }}</td>
                            <td class="col-prodotto">{{ ordine.prodotto.nome }}</td>
                            <td class="col-stato">{{ ordine.ordine.dataordine }}</td>
                            <td class="col-stato">{{ ordine.qta }}</td>
                            <td class="col-stato">${{ "%.2f"|format(ordine.pagato) }}</td>
                            <td class="col-stato">Completato</td>
                        </tr>
            {% if loop.last  %}
                    </tbody>
                </table>
            {% endif %}
        {% endfor %}
    {% else %}
        <p class="text-center">Non hai ordini precedenti.</p>
    {% endif %}
    <td><a href="{{ url_for('auth.user_profile') }}" class="btn btn-success">Indietro</a></td>
</div>
{% endblock %}
